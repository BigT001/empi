# üîß Paystack Configuration - Setup Required\n\n## Current Issue\nThe checkout button is not responding because **Paystack API keys are missing or invalid**.\n\nError received:\n```\nPaystack error: Invalid key\nMessage: 'Ensure that you provide the correct authorization key for the request'\n```\n\n---\n\n## Solution: Add Your Paystack Keys\n\n### Step 1: Get Your Paystack Keys\n\n1. Go to **https://dashboard.paystack.com**\n2. Log in with your Paystack account (create one if needed)\n3. Navigate to **Settings ‚Üí API Keys & Webhooks**\n4. You'll see two keys:\n   - **Public Key** (starts with `pk_`)\n   - **Secret Key** (starts with `sk_`)\n\nExample:\n```\nPublic Key:  pk_test_abc123def456ghi789jkl012mno345\nSecret Key:  sk_test_xyz789uvw456rst123opq890def567\n```\n\n### Step 2: Add Keys to Environment\n\nOpen `.env.local` and update:\n\n```bash\n# Paystack Payment Gateway\nPAYSTACK_PUBLIC_KEY=\"pk_test_YOUR_PUBLIC_KEY_HERE\"\nPAYSTACK_SECRET_KEY=\"sk_test_YOUR_SECRET_KEY_HERE\"\n```\n\n**IMPORTANT:** \n- Replace with YOUR ACTUAL keys from Paystack dashboard\n- Use **TEST keys** for development (they start with `pk_test` and `sk_test`)\n- NEVER commit real keys to git\n- Add `.env.local` to `.gitignore` (already done)\n\n### Step 3: Restart Dev Server\n\n```bash\n# Stop current server (Ctrl+C)\n# Then run:\nnpm run dev\n```\n\nThe environment will reload automatically with new keys.\n\n---\n\n## Testing Payment Flow\n\nOnce keys are added:\n\n1. **Add items to cart**\n   - Go to http://localhost:3000\n   - Add 2-3 items to cart\n\n2. **Go to checkout**\n   - Navigate to http://localhost:3000/cart\n   - Click \"Proceed to Checkout\"\n\n3. **Review order**\n   - Select shipping option (EMPI or Self Pickup)\n   - Review total amount\n   - Click \"Pay [amount]\" button\n\n4. **Paystack Payment Modal**\n   - Paystack modal should appear\n   - Use test card credentials:\n     ```\n     Card Number:  4111 1111 1111 1111\n     Expiry:       01/35\n     CVV:          123\n     OTP:          123456\n     ```\n\n5. **Success Confirmation**\n   - Should see \"Payment successful\" message\n   - Invoice generated with shipping info\n   - Order confirmed\n\n---\n\n## What Was Fixed\n\n‚úÖ **Deleted corrupted ShippingContext.tsx** file that had encoding issues\n‚úÖ **Fixed all TypeScript compilation errors**\n‚úÖ **Dev server now running without errors**\n‚úÖ **Added placeholder for Paystack keys**\n\n---\n\n## Troubleshooting\n\n### \"Invalid key\" Error\n- **Cause:** Wrong or missing Paystack API keys\n- **Solution:** Copy exact keys from Paystack dashboard\n- **Verify:** Go to Settings ‚Üí API Keys ‚Üí copy both public and secret keys\n\n### \"Payment initialization failed\"\n- **Cause:** Network issue or API endpoint down\n- **Solution:** Check internet connection, verify Paystack is accessible\n- **Verify:** Test in browser console:\n  ```javascript\n  fetch('/api/payments/paystack/initialize', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({\n      email: 'test@example.com',\n      amount: 100,\n      orderId: 'TEST-001'\n    })\n  }).then(r => r.json()).then(console.log)\n  ```\n\n### \"Missing payment details\"\n- **Cause:** Email or amount is null/empty\n- **Solution:** Ensure cart has items and checkout form is filled\n- **Verify:** Check console for empty values\n\n---\n\n## Environment Variables Reference\n\n### Current .env.local\n```bash\n# Database\nMONGODB_URI=\"...connection string...\"\n\n# Cloudinary (Image Upload)\nNEXT_PUBLIC_CLOUDINARY_CLOUD_NAME=\"...\"\nCLOUDINARY_API_KEY=\"...\"\nCLOUDINARY_API_SECRET=\"...\"\nCLOUDINARY_URL=\"...\"\n\n# Auth\nNEXTAUTH_SECRET=\"...\"\n\n# Paystack (NEEDS TO BE ADDED) ‚¨áÔ∏è\nPAYSTACK_PUBLIC_KEY=\"pk_test_YOUR_KEY\"\nPAYSTACK_SECRET_KEY=\"sk_test_YOUR_KEY\"\n```\n\n---\n\n## Test Payment Card Details\n\n### Successful Payment\n```\nCard Number:    4111 1111 1111 1111\nExpiry Month:   01\nExpiry Year:    35\nCVV:           123\nOTP:           123456 (when prompted)\n```\n\n### Failed Payment Test\n```\nCard Number:    4012 8888 8888 8881\nExpiry Month:   01\nExpiry Year:    35\nCVV:           123\n```\n\n### Insufficient Funds Test\n```\nCard Number:    4111 1111 1111 1130\nExpiry Month:   01\nExpiry Year:    35\nCVV:           123\n```\n\n---\n\n## API Endpoint Check\n\nTo verify the payment API is working:\n\n```bash\n# In terminal (PowerShell):\ncurl -X POST http://localhost:3000/api/payments/paystack/initialize `\n  -H \"Content-Type: application/json\" `\n  -d '{\"email\":\"test@example.com\",\"amount\":100,\"orderId\":\"TEST-001\"}'\n```\n\nShould return:\n```json\n{\n  \"status\": true,\n  \"data\": {\n    \"authorizationUrl\": \"https://checkout.paystack.com/...\",\n    \"reference\": \"ORDER-TEST-001-...\"\n  }\n}\n```\n\nIf you get \"Invalid key\", the Paystack secret key in environment is wrong.\n\n---\n\n## Next Steps\n\n1. ‚úÖ Get Paystack account (https://paystack.com)\n2. ‚úÖ Copy your API keys\n3. ‚úÖ Paste into `.env.local`:\n   ```\n   PAYSTACK_PUBLIC_KEY=\"pk_test_your_actual_key\"\n   PAYSTACK_SECRET_KEY=\"sk_test_your_actual_key\"\n   ```\n4. ‚úÖ Save file\n5. ‚úÖ Server auto-reloads\n6. ‚úÖ Test payment flow\n7. ‚úÖ All shipping options work with payment\n\n---\n\n## Summary\n\n**Status:** üîß Requires Paystack API keys  \n**Files Fixed:** \n- ‚úÖ Deleted corrupted ShippingContext.tsx\n- ‚úÖ Fixed TypeScript errors\n- ‚úÖ Updated .env files with placeholder keys\n\n**Ready to test:** Once you add real Paystack keys to `.env.local`\n\n**Estimated time:** 5 minutes to add keys + test\n\n---\n\n**Questions?** All shipping options are configured. Only payment needs Paystack keys!\n